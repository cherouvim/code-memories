DECLARE SUB DRAWSCR ()
DECLARE SUB REDEFINE ()
DECLARE SUB MENU ()
DECLARE SUB CHECKP ()
DECLARE SUB MAIN ()
DECLARE SUB DRAWP ()
DECLARE SUB C.P.O.Z ()
DECLARE SUB C.P ()
DECLARE SUB GAME ()
DECLARE SUB MAKEP ()
DECLARE SUB MAKEPRIGHT ()
DIM SHARED PIC(1000)
DIM SHARED P(4, 4)
DIM SHARED PRIGHT(4, 4), PRIGHT, X, Y, XX, YY, U$, D$, L$, R$
SCREEN 13
MAIN
DATA 0,15,14,13
DATA 12,11,10,9
DATA 8,7,6,5
DATA 4,3,2,1
DATA 1,2,3,4
DATA 5,6,7,8
DATA 9,10,11,12
DATA 13,14,15,0

SUB C.P
IF XX = 1 THEN
 P(X - 1, Y) = P(X, Y)
 P(X, Y) = 0
XX = 0
END IF
IF XX = -1 THEN
 P(X + 1, Y) = P(X, Y)
 P(X, Y) = 0
XX = 0
END IF
IF YY = 1 THEN
 P(X, Y - 1) = P(X, Y)
 P(X, Y) = 0
YY = 0
END IF
IF YY = -1 THEN
 P(X, Y + 1) = P(X, Y)
 P(X, Y) = 0
YY = 0
END IF
END SUB

SUB C.P.O.Z
'CHECK POSITION OF ZERO
FOR Y = 1 TO 4
FOR X = 1 TO 4
IF P(X, Y) = 0 THEN PX = X: PY = Y
NEXT X
NEXT Y
X = PX
Y = PY
END SUB

SUB CHECKP
P = 0
FOR Y1 = 1 TO 4
FOR X1 = 1 TO 4
IF P(X1, Y1) <> PRIGHT(X1, Y1) THEN P = P + 1
NEXT X1
NEXT Y1
IF P = 0 THEN PRIGHT = 1: BEEP: PRINT "CONGRATULATONS"
END SUB

SUB DRAWP
X = X - 1
Y = Y - 1
GET (X * 25 + 110, Y * 25 + 50)-(X * 25 + 134, Y * 25 + 74), PIC
PUT (X * 25 + 110, Y * 25 + 50), PIC
IF XX = 1 THEN
 FOR I = 0 TO 24
  PUT (X * 25 + 110 - I, Y * 25 + 50), PIC
  FOR L = 1 TO 100: NEXT L
  PUT (X * 25 + 110 - I, Y * 25 + 50), PIC
 NEXT I
PUT (X * 25 + 110 - I, Y * 25 + 50), PIC
END IF
IF XX = -1 THEN
 FOR I = 0 TO 24
  PUT (X * 25 + 110 + I, Y * 25 + 50), PIC
  FOR L = 1 TO 100: NEXT L
  PUT (X * 25 + 110 + I, Y * 25 + 50), PIC
 NEXT I
PUT (X * 25 + 110 + I, Y * 25 + 50), PIC
END IF
IF YY = 1 THEN
 FOR I = 0 TO 24
  PUT (X * 25 + 110, Y * 25 + 50 - I), PIC
  FOR L = 1 TO 100: NEXT L
  PUT (X * 25 + 110, Y * 25 + 50 - I), PIC
 NEXT I
PUT (X * 25 + 110, Y * 25 + 50 - I), PIC
END IF
IF YY = -1 THEN
 FOR I = 0 TO 24
  PUT (X * 25 + 110, Y * 25 + 50 + I), PIC
  FOR L = 1 TO 100: NEXT L
  PUT (X * 25 + 110, Y * 25 + 50 + I), PIC
 NEXT I
PUT (X * 25 + 110, Y * 25 + 50 + I), PIC
END IF

X = X + 1
Y = Y + 1
'FOR Y1 = 1 TO 4
'FOR X1 = 1 TO 4
'LOCATE Y1, X1 * 2: PRINT HEX$(P(X1, Y1))
'IF P(X1, Y1) = 0 THEN LOCATE Y1, X1 * 2: PRINT "°"
'NEXT X1
'NEXT Y1
END SUB

SUB DRAWSCR
LINE (109, 49)-(210, 150), 7, BF
CIRCLE (160, 100), 50, 15
LINE (110, 50)-(134, 74), 0, BF
END SUB

SUB GAME
DRAWSCR
C.P.O.Z
X = 1
Y = 1
A1:
W$ = INKEY$
IF W$ = R$ THEN A = 1: IF X < 4 THEN X = X + 1: XX = 1: DRAWP: C.P: CHECKP
IF W$ = L$ THEN A = 1: IF X > 1 THEN X = X - 1: XX = -1: DRAWP: C.P: CHECKP
IF W$ = D$ THEN A = 1: IF Y < 4 THEN Y = Y + 1: YY = 1: DRAWP: C.P: CHECKP
IF W$ = U$ THEN A = 1: IF Y > 1 THEN Y = Y - 1: YY = -1: DRAWP: C.P: CHECKP
IF W$ <> "" AND A = 0 THEN END
IF A = 1 THEN A = 0
GOTO A1:
END SUB

SUB MAIN
MENU
MAKEP
MAKEPRIGHT
GAME
END SUB

SUB MAKEP
FOR Y1 = 1 TO 4
FOR X1 = 1 TO 4
READ A
P(X1, Y1) = A
NEXT X1
NEXT Y1
END SUB

SUB MAKEPRIGHT
FOR Y = 1 TO 4
FOR X = 1 TO 4
READ A
PRIGHT(X, Y) = A
NEXT X
NEXT Y

END SUB

SUB MENU
U$ = CHR$(0) + "P"
D$ = CHR$(0) + "H"
L$ = CHR$(0) + "M"
R$ = CHR$(0) + "K"
PRINT "1. GAME"
PRINT "2. REDEFINE KEYS"
PRINT "3. EXIT"
A2:
W$ = INKEY$
IF W$ = "" THEN GOTO A2:
IF W$ <> "1" AND W$ <> "2" AND W$ <> "3" THEN GOTO A2:
IF W$ = "2" THEN REDEFINE
IF W$ = "3" THEN END
CLS
END SUB

SUB REDEFINE
DIM KEY$(4)
KEY$(1) = "UP    "
KEY$(2) = "DOWN  "
KEY$(3) = "LEFT  "
KEY$(4) = "RIGHT "
FOR I = 1 TO 4
PRINT "ENTER KEY FOR "; KEY$(I);
A3:
W$ = INKEY$
IF W$ = "" THEN GOTO A3:
KEY$(I) = W$
PRINT KEY$(I)
NEXT I
U$ = KEY$(1)
D$ = KEY$(2)
L$ = KEY$(3)
R$ = KEY$(4)
END SUB

